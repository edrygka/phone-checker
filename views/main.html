
<!doctype html>
<html>
<head>
	<title>Service</title>
	<link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">
  <script src="https://code.jquery.com/jquery-2.1.4.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script>
  <script>
    async function handleFiles(){
      const file = document.getElementById("upload-file").files[0]
      const formData = new FormData()
      if (file.name.slice((Math.max(0, file.name.lastIndexOf(".")) || Infinity) + 1) !== 'txt') {
        document.getElementById("upload-file").value = ''
        return alert('File is not txt')
      }

      formData.append("file", file)
      const response = await fetch('https://localhost:3000/upload/file', {method: "POST", body: formData})
      const data = await response.json()
      document.getElementById('status').innerText += Math.floor((data.file_size) / 1e6) + ' Mb'
    }

    async function checkViber(){
      fetch('http://localhost:3000/trigger').then(result => {

      })
    }

    async function checkTg(){
      
    }
  </script>  
</head>
<body>
  <div class="jumbotron text-center">
    <div class="row">
      <div id="profile-info" class="col-sm-6">
        <div class="well">
          <h3><span class="fa fa-star"></span> Загрузить файл с номерами</h3>
          <div class="form-group">
            <input type="file" class="form-control" id="upload-file" onchange="handleFiles();">
          </div>
          <div class="form-group">
            <span id='status'>Размер файла: </span>
          </div>
        </div>
      </div>
      <div id="profile-info" class="col-sm-6">
        <div class="well">
          <h3><span class="fa fa-gear"></span> Проверить номера из файла</h3>
          <button class="btn btn-primary btn-sm" onclick="checkViber();"> Проверить viber</button>
          <button class="btn btn-primary btn-sm" onclick="checkTg();"> Проверить telegram</button><br>
          <strong>Статус</strong> : <label id="balance"> </label> <br>
        </div>
      </div>
      <div id="profile-info" class="col-sm-6">
        <div class="well">
          <h3><span class="fa fa-glass"></span> Сделать рассылку(Появится в будущем)</h3>
          <div class="form-group">
          </div>
        </div>
      </div>
    </div>
	</div>
</body>
</html>
